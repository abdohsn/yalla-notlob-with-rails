{"ast":null,"code":"import consumer from \"./consumer\";\nconsumer.subscriptions.create(\"NotificationChannel\", {\n  connected: function connected() {\n    console.log(\"connected ya ray2\"); // Called when the subscription is ready for use on the server\n  },\n  disconnected: function disconnected() {// Called when the subscription has been terminated by the server\n  },\n  received: function received(data) {\n    console.log(data);\n\n    if (data[\"header\"] == \"validate email\") {\n      if (data[\"body\"] == \"valid\") {\n        var errorid = \"#orderFriendsErrors\" + data[\"userId\"];\n\n        if ($(errorid).length) {\n          $(errorid).empty();\n        }\n\n        var friendsToAdd = \"#friendsToAdd\" + data[\"userId\"];\n\n        if ($(friendsToAdd).val().indexOf(data.email) == -1) {\n          $(friendsToAdd).val($(friendsToAdd).val() + data.email + \" \");\n          var id = \"#orderFriends\" + data[\"userId\"];\n\n          if ($(id).length) {\n            var user = {\n              id: data.friend[0][\"friend_id\"],\n              email: data.email\n            };\n            var clickId = \"member\".concat(data.friend[0].friend_id, \"click\");\n            var addedElement = \"<div class = \\\"message text-center border p-3 mt-2\\\" id=member\".concat(data.friend[0].friend_id, \"><p>\").concat(data.email, \"</p><span class = \\\"btn btn-danger\\\" userId = \").concat(data[\"userId\"], \" email = \").concat(data[\"email\"], \" id=\").concat(clickId, \"> Delete</span></div>\");\n            $(id).append(addedElement);\n            $(id).on(\"click\", \"div > \".concat(\"#\" + clickId), function (e) {\n              var hiddenInput = $(\"#friendsToAdd\" + $(\"#\" + e.target.id).attr(\"userid\"));\n              var deletedEmail = $(\"#\" + e.target.id).attr(\"email\");\n              $(\"#\" + e.target.id).closest(\"div\").fadeOut().remove();\n              $(hiddenInput).val($(hiddenInput).val().replace(deletedEmail, \"\"));\n              console.log($(hiddenInput).val());\n            });\n          }\n        } else {\n          errorMsg(\"you cant add the same member twice\", data);\n        }\n      } else {\n        errorMsg(data.body, data);\n      }\n    } else if (data[\"header\"] == \"new item\") {\n      // id=\"order<%=@order.id%>user<%=current_user.id%>\"\n      console.log(\"done\");\n      console.log(data[\"users\"]);\n      var ids = data[\"users\"].map(function (user) {\n        return \"#order\" + data[\"order_id\"] + \"user\" + user;\n      });\n      ids.map(function (user) {\n        if ($(user).length) {\n          $(user).append('<tr><td>' + data[\"orderItem\"].name + '</td><td>' + data[\"orderItem\"].item_name + '</td><td>' + data[\"orderItem\"].amount + '</td><td>' + data[\"orderItem\"].price + '</td><td>' + data[\"orderItem\"].comment + '</td></tr>'); // Called when there's incoming data on the websocket for this channel\n        }\n      });\n    } else {\n      var _id = \"#notification\" + data[\"userId\"];\n\n      if ($(_id).length) {\n        $(_id).append('<h1 class = \"message\" style=\"border-bottom: 1px solid black\">' + data.body + \"</h1>\");\n        $(_id + \"Trigger\").click().promise().done(function () {\n          setTimeout(function () {\n            console.log(\"heelllo\");\n            $(_id + \"Trigger\").click();\n          }, 3000);\n        }); // $(id+\"Modal\").delay(3000).attr(\"class\",\"modal fade\")\n\n        var audioElement = document.createElement('audio');\n        audioElement.setAttribute('src', 'https://cdn.staticcrate.com/stock-hd/audio/soundscrate-click-fx-tonal-18.mp3');\n        audioElement.play();\n        console.log(\"I'm here nw \");\n      }\n    } // Called when there's incoming data on the websocket for this channel\n\n  }\n});\n\nfunction errorMsg(msg, data) {\n  var id = \"#orderFriendsErrors\" + data[\"userId\"];\n\n  if ($(id).length) {\n    $(id).empty();\n    $(id).append('<span class = \"message text-danger\">' + msg + \"</span>\");\n  }\n}","map":{"version":3,"sources":["/home/ahmed/ITI/Rails_Project/yalla-notlob-with-rails/app/javascript/channels/notification_channel.js"],"names":["consumer","subscriptions","create","connected","console","log","disconnected","received","data","errorid","$","length","empty","friendsToAdd","val","indexOf","email","id","user","friend","clickId","friend_id","addedElement","append","on","e","hiddenInput","target","attr","deletedEmail","closest","fadeOut","remove","replace","errorMsg","body","ids","map","name","item_name","amount","price","comment","click","promise","done","setTimeout","audioElement","document","createElement","setAttribute","play","msg"],"mappings":"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","sourcesContent":["import consumer from \"./consumer\";\n\nconsumer.subscriptions.create(\"NotificationChannel\", {\n  connected() {\n    console.log(\"connected ya ray2\");\n    // Called when the subscription is ready for use on the server\n  },\n  disconnected() {\n    // Called when the subscription has been terminated by the server\n  },\n\n  received(data) {\n    console.log(data);\n    if (data[\"header\"] == \"validate email\") {\n      if (data[\"body\"] == \"valid\") {\n        let errorid = \"#orderFriendsErrors\" + data[\"userId\"];\n        if ($(errorid).length) {\n          $(errorid).empty();\n        }\n\n        let friendsToAdd = \"#friendsToAdd\" + data[\"userId\"];\n        if ($(friendsToAdd).val().indexOf(data.email) == -1) {\n          $(friendsToAdd).val($(friendsToAdd).val() + data.email + \" \");\n          let id = \"#orderFriends\" + data[\"userId\"];\n          if ($(id).length) {\n            let user = {\n              id :data.friend[0][\"friend_id\"],\n              email : data.email\n            }\n            let clickId= `member${data.friend[0].friend_id}click`\n                let addedElement = `<div class = \"message text-center border p-3 mt-2\" id=member${data.friend[0].friend_id}><p>${data.email}</p><span class = \"btn btn-danger\" userId = ${data[\"userId\"]} email = ${data[\"email\"]} id=${clickId}> Delete</span></div>`\n            $(id).append(addedElement);\n            $(id).on(\"click\",`div > ${\"#\"+clickId}`, (e)=>{\n              let hiddenInput = $(\"#friendsToAdd\"+$(\"#\"+ e.target.id).attr(\"userid\"))\n              let deletedEmail = $(\"#\"+ e.target.id).attr(\"email\")\n              $(\"#\"+ e.target.id).closest(\"div\").fadeOut().remove();\n              $(hiddenInput).val($(hiddenInput).val().replace(deletedEmail ,\"\"))\n              console.log( $(hiddenInput).val() )\n            })\n          }\n        } else {\n          errorMsg(\"you cant add the same member twice\", data);\n        }\n      } else {\n        errorMsg(data.body, data);\n      }\n    } else if(data[\"header\"] ==  \"new item\"){\n\n      // id=\"order<%=@order.id%>user<%=current_user.id%>\"\n\n\n      console.log(\"done\");\n      console.log(data[\"users\"]);\n      let ids =  data[\"users\"].map(user => \"#order\"+data[\"order_id\"]+\"user\"+user);\n\n      ids.map(user => {\n        if($(user).length) {\n          $(user).append('<tr><td>' + data[\"orderItem\"].name + '</td><td>' + data[\"orderItem\"].item_name + '</td><td>' + data[\"orderItem\"].amount + '</td><td>' + data[\"orderItem\"].price + '</td><td>' + data[\"orderItem\"].comment + '</td></tr>')\n          // Called when there's incoming data on the websocket for this channel\n        }\n      });\n    }\n    \n    else {\n      let id = \"#notification\" + data[\"userId\"];\n      if ($(id).length) {\n        $(id).append('<h1 class = \"message\" style=\"border-bottom: 1px solid black\">' + data.body + \"</h1>\");\n        $(id+\"Trigger\").click()\n            .promise().done(\n            function(){\n            setTimeout( ()=> {\n                  console.log(\"heelllo\")\n              $(id+\"Trigger\").click()\n\n                }\n                ,3000)\n            }\n        );\n        // $(id+\"Modal\").delay(3000).attr(\"class\",\"modal fade\")\n        var audioElement = document.createElement('audio');\n        audioElement.setAttribute('src', 'https://cdn.staticcrate.com/stock-hd/audio/soundscrate-click-fx-tonal-18.mp3');\n        audioElement.play();\n        console.log(\"I'm here nw \")\n      }\n    }\n\n    // Called when there's incoming data on the websocket for this channel\n  },\n});\nfunction errorMsg(msg, data) {\n\n  let id = \"#orderFriendsErrors\" + data[\"userId\"];\n  if ($(id).length) {\n    $(id).empty();\n    $(id).append('<span class = \"message text-danger\">' + msg + \"</span>\");\n\n  }\n}\n\n"]},"metadata":{},"sourceType":"module"}